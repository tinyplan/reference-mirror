name: æ¯å¤©1ç‚¹åŒæ­¥ä¸€æ¬¡reference
on:
  schedule:
    - cron: '0 1 * * *' # å®šæ—¶ä»»åŠ¡
  workflow_dispatch:       # æ‰‹åŠ¨è¿è¡Œ

env:
  TZ: Asia/Shanghai

jobs:
  sync-ref-mirror: # è‡ªå®šä¹‰åç§°
    runs-on: ubuntu-latest
    steps:
      - name: ğŸšœ æ‹‰å–æœ€æ–°ä»£ç 
        uses: actions/checkout@v4
        with:
          ref: 'main'
          repository: 'jaywcjlove/reference'

      - name: â™»ï¸ ç¼–è¯‘é™æ€æ–‡ä»¶
        run: |
          echo -e 'REF_URL=http://ref.tinyplan.cn/\nREF_LABEL=ç½‘ç«™é¦–é¡µ' > .env
          npm install
          npm run build

      - name: ğŸš éƒ¨ç½²åˆ°æœåŠ¡å™¨
        uses: wlixcc/SFTP-Deploy-Action@v1.2.4
        with:
          username: '${{ secrets.DEPLOY_USER }}'
          port: '${{ secrets.DEPLOY_PORT }}'
          server: '${{ secrets.DEPLOY_HOST }}'
          ssh_private_key: '${{ secrets.DEPLOY_SECRET_KEY }}'
          local_path: './dist/*'
          remote_path: '/data/static/reference'
          delete_remote_files: true